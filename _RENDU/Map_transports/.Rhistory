theme_minimal()
scatter_plots[[i - 1]] <- p
}
do.call(grid.arrange, c(scatter_plots[c(3)], ncol = 1))
# Tracé des graphes de points et de la linéarité
scatter_plots <- list()
for (i in 2:11) {
p <- ggplot(data, aes_string(x = data[[i]], y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = nomsdevar[i-1], y = "Happiness") +
theme_minimal()
scatter_plots[[i - 1]] <- p
}
do.call(grid.arrange, c(scatter_plots[c(3)], ncol = 1))
# Tracé des graphes de points et de la linéarité
scatter_plots <- list()
for (i in 2:11) {
p <- ggplot(data, aes_string(x = data[[i]], y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = nomsdevar[i-1], y = "Happiness") +
theme_minimal()
scatter_plots[[i - 1]] <- p
}
do.call(grid.arrange, c(scatter_plots[c(3)], ncol = 1))
# Corrélations simples et affichage graphique (base R)
vars <- names(data_numeric)[-ncol(data_numeric)]
cors <- sapply(vars, function(v) cor(data_numeric$Happiness, data_numeric[[v]]))
# trier par valeur (pour barplot horizontal)
names(cors) = nomsdevar
cors_sorted <- sort(cors)
par(mar = c(5, 8, 4, 2))
barplot(cors_sorted,
horiz = TRUE, las = 1,
# bicolor
col = ifelse(cors_sorted > 0, "lightblue", "salmon1"),
main = "Corrélations avec l'indice de bonheur",
)
abline(v = 0, lty = 2, col = "grey40")
par(mar = c(5, 4, 4, 2) + 0.1)
data_PIB_log <- data
data_PIB_log$GDP_per_Capita <- log(data_PIB_log$GDP_per_Capita)
PIBplot <- ggplot(data_PIB_log, aes_string(x = "GDP_per_Capita", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Logarithme du PIB par habitant", y = "Happiness") +
theme_minimal()
data_KWH_log <- data
data_KWH_log$KWH_pp_pc <- log(data_KWH_log$KWH_pp_pc)
KWHplot <- ggplot(data_KWH_log, aes_string(x = "KWH_pp_pc", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Logarithme de la consommmation énergétique", y = "Happiness") +
theme_minimal()
data_migration <- data
data_migration$Net_Migration <- log(data_migration$Net_Migration)
migrationplot <- ggplot(data_migration, aes_string(x = "Net_Migration", y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Logarithme de la migration", y = "Happiness") +
theme_minimal()
logplots <- list(PIBplot, KWHplot, migrationplot)
do.call(grid.arrange, c(scatter_plots[c(2,7)],logplots[c(1,2)], ncol = 2))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
sspopplot <- ggplot(data_ss_singapour, aes_string(x = "Population_Density", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans Singapour", y = "Happiness") +
theme_minimal()
data_ss_somalie <- data[-which(data$Code == "SOM"), ]
ssschoolplot <- ggplot(data_ss_somalie, aes_string(x = "Primary_School_Enrollment", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans la Somalie", y = "Happiness") +
theme_minimal()
data_ss_pak_usa <- data[-which(data$Code == "PAK" | data$Code == "USA"), ]
ssmigrationplot <- ggplot(data_ss_pak_usa, aes_string(x = "Net_Migration", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans les EU ni le Pakistan", y = "Happiness") +
theme_minimal()
outlierplots <- list(ssmigrationplot, sspopplot, ssschoolplot)
do.call(grid.arrange, c(c(scatter_plots[c(4,6,10)],outlierplots), ncol = 3))
library(googleway)
#install.packages('leaflet')
#install.packages('sf')
#install.packages('shiny')
#install.packages("mapsapi")
#install.packages("gtfsrouter")
#install.packages("tidytransit")
#install.packages("stplanr")
install.packages('googleway')
library(googleway)
library(mapsapi)
library(sf)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(leaflet)
library(shiny)
library(dplyr)
library(stringr)
library(httr)
library(jsonlite)
library(gtfsrouter)
library(tidytransit)
library(stplanr)
commune_voiture_velo3 = read.csv2( "Transports_Voit_Velo_Bus.csv",
header = TRUE,
sep = ";",
dec = ".",
quote = "\"",
stringsAsFactors = FALSE
)
setwd("C:/Users/dejaj/OneDrive/Bureau/rennesdatachallenge2026")
commune_voiture_velo3 = read.csv2( "Transports_Voit_Velo_Bus.csv",
header = TRUE,
sep = ";",
dec = ".",
quote = "\"",
stringsAsFactors = FALSE
)
View(Transports_Voit_Velo_Bus)
View(commune_voiture_velo3)
# ---------------- UI ----------------
ui <- fluidPage(
titlePanel("Carte interactive des communes étudiées"),
sidebarLayout(
sidebarPanel(
helpText("Affichage uniquement des communes étudiées (communes_etudiees == TRUE).")
),
mainPanel(
leafletOutput("map", height = 650)
)
)
)
# ---------------- SERVER ----------------
server <- function(input, output, session) {
output$map <- renderLeaflet({
# Filtrer les communes étudiées
df_filtre <- commune_voiture_velo3 %>% filter(communes_etudiees == TRUE)
# Construire le label HTML pour le tooltip
labels <- lapply(1:nrow(df_filtre), function(i) {
row <- df_filtre[i, ]
# Condition temps voiture > 60 ou NA
if (is.na(row$Voiture_Pontchaillou_min) | is.na(row$Voiture_HopitalSud_min) |
row$Voiture_Pontchaillou_min > 60 | row$Voiture_HopitalSud_min > 60) {
label <- paste0(
"<b>", row$nom, "</b><br/>",
"Voiture temps moyen (min) : ", round(row$Voiture_min, 1), "<br/>",
"Voiture distance moyenne (km) : ", round(row$Voiture_km, 1)
)
} else {
# Affichage détaillé, sans les NA
label <- paste0(
"<b>", row$nom, "</b><br/>",
if (!is.na(row$Voiture_Pontchaillou_min)) paste0("Voiture Pontchaillou (min) : ", row$Voiture_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Voiture_Pontchaillou_km)) paste0("Voiture Pontchaillou (km) : ", row$Voiture_Pontchaillou_km, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_min)) paste0("Voiture Hopital Sud (min) : ", row$Voiture_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_km)) paste0("Voiture Hopital Sud (km) : ", row$Voiture_HopitalSud_km, "<br/>") else "",
if (!is.na(row$Velo_Pontchaillou_min)) paste0("Velo Pontchaillou (min) : ", row$Velo_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Velo_HopitalSud_min)) paste0("Velo Hopital Sud (min) : ", row$Velo_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Bus_Pontchaillou)) paste0("Bus Pontchaillou (min) : ", row$Bus_Pontchaillou, "<br/>") else "",
if (!is.na(row$Bus_HopitalSud)) paste0("Bus Hopital Sud (min) : ", row$Bus_HopitalSud, "<br/>") else ""
)
}
HTML(label)
})
# Carte Leaflet
leaflet(df_filtre) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
radius = 5,
fillColor = "blue",
fillOpacity = 0.7,
stroke = FALSE,
label = labels
)
})
}
# ---------------- Lancer l'application Shiny ----------------
shinyApp(ui, server)
# ---------------- SERVER ----------------
server <- function(input, output, session) {
output$map <- renderLeaflet({
# Filtrer les communes étudiées
df_filtre <- commune_voiture_velo3 %>% filter(communes_etudiees == TRUE)
# Construire le label HTML pour le tooltip
labels <- lapply(1:nrow(df_filtre), function(i) {
row <- df_filtre[i, ]
# Condition temps voiture > 60 ou NA
if (is.na(row$Voiture_Pontchaillou_min) | is.na(row$Voiture_HopitalSud_min) |
row$Voiture_Pontchaillou_min > 60 | row$Voiture_HopitalSud_min > 60) {
label <- paste0(
"<b>", row$nom, "</b><br/>",
"Voiture temps moyen (min) : ", round(row$Voiture_min, 1), "<br/>",
"Voiture distance moyenne (km) : ", round(row$Voiture_km, 1)
)
} else {
# Affichage détaillé, sans les NA
label <- paste0(
"<b>", row$nom, "</b><br/>",
if (!is.na(row$Voiture_Pontchaillou_km)) paste0("Distance Pontchaillou (km) : ", row$Voiture_Pontchaillou_km, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_km)) paste0("Distance Hopital Sud (km) : ", row$Voiture_HopitalSud_km, "<br/>") else "",
if (!is.na(row$Voiture_Pontchaillou_min)) paste0("Voiture Pontchaillou (min) : ", row$Voiture_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_min)) paste0("Voiture Hopital Sud (min) : ", row$Voiture_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Velo_Pontchaillou_min)) paste0("Velo Pontchaillou (min) : ", row$Velo_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Velo_HopitalSud_min)) paste0("Velo Hopital Sud (min) : ", row$Velo_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Bus_Pontchaillou)) paste0("Bus Pontchaillou (min) : ", row$Bus_Pontchaillou, "<br/>") else "",
if (!is.na(row$Bus_HopitalSud)) paste0("Bus Hopital Sud (min) : ", row$Bus_HopitalSud, "<br/>") else ""
)
}
HTML(label)
})
# Carte Leaflet
leaflet(df_filtre) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
radius = 5,
fillColor = "blue",
fillOpacity = 0.7,
stroke = FALSE,
label = labels
)
})
}
# ---------------- Lancer l'application Shiny ----------------
map =  shinyApp(ui, server)
# ---------------- Lancer l'application Shiny ----------------
shinyApp(ui, server)
# ---------------- Lancer l'application Shiny ----------------
map = shinyApp(ui, server)
saveWidget(
widget = map,
file = "carte_communes.html",
selfcontained = TRUE
)
library(htmlwidgets)
#install.packages('leaflet')
#install.packages('sf')
#install.packages('shiny')
#install.packages("mapsapi")
#install.packages("gtfsrouter")
#install.packages("tidytransit")
#install.packages("stplanr")
#install.packages('googleway')
install.packages("htmlwidgets")
install.packages("htmlwidgets")
install.packages("htmlwidgets")
install.packages("htmlwidgets")
library(htmlwidgets)
saveWidget(
widget = map,
file = "carte_communes.html",
selfcontained = TRUE
)
saveWidget(
widget = map,
file = "carte_communes.html",
selfcontained = FALSE
)
# ---------------- Lancer l'application Shiny ----------------
map = shinyApp(ui, server)
saveWidget(
widget = map,
file = "carte_communes.html",
selfcontained = FALSE
)
map
setwd("C:/Users/dejaj/OneDrive/Bureau/rennesdatachallenge2026/Map_transports")
commune_voiture_velo3 = read.csv2( "Transports_Voit_Velo_Bus.csv",
header = TRUE,
sep = ";",
dec = ".",
quote = "\"",
stringsAsFactors = FALSE
)
# ---------------- UI ----------------
ui <- fluidPage(
titlePanel("Carte interactive des communes étudiées"),
sidebarLayout(
sidebarPanel(
helpText("Affichage uniquement des communes étudiées (communes_etudiees == TRUE).")
),
mainPanel(
leafletOutput("map", height = 650)
)
)
)
# ---------------- SERVER ----------------
server <- function(input, output, session) {
output$map <- renderLeaflet({
# Filtrer les communes étudiées
df_filtre <- commune_voiture_velo3 %>% filter(communes_etudiees == TRUE)
# Construire le label HTML pour le tooltip
labels <- lapply(1:nrow(df_filtre), function(i) {
row <- df_filtre[i, ]
# Condition temps voiture > 60 ou NA
if (is.na(row$Voiture_Pontchaillou_min) | is.na(row$Voiture_HopitalSud_min) |
row$Voiture_Pontchaillou_min > 60 | row$Voiture_HopitalSud_min > 60) {
label <- paste0(
"<b>", row$nom, "</b><br/>",
"Voiture temps moyen (min) : ", round(row$Voiture_min, 1), "<br/>",
"Voiture distance moyenne (km) : ", round(row$Voiture_km, 1)
)
} else {
# Affichage détaillé, sans les NA
label <- paste0(
"<b>", row$nom, "</b><br/>",
if (!is.na(row$Voiture_Pontchaillou_km)) paste0("Distance Pontchaillou (km) : ", row$Voiture_Pontchaillou_km, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_km)) paste0("Distance Hopital Sud (km) : ", row$Voiture_HopitalSud_km, "<br/>") else "",
if (!is.na(row$Voiture_Pontchaillou_min)) paste0("Voiture Pontchaillou (min) : ", row$Voiture_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_min)) paste0("Voiture Hopital Sud (min) : ", row$Voiture_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Velo_Pontchaillou_min)) paste0("Velo Pontchaillou (min) : ", row$Velo_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Velo_HopitalSud_min)) paste0("Velo Hopital Sud (min) : ", row$Velo_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Bus_Pontchaillou)) paste0("Bus Pontchaillou (min) : ", row$Bus_Pontchaillou, "<br/>") else "",
if (!is.na(row$Bus_HopitalSud)) paste0("Bus Hopital Sud (min) : ", row$Bus_HopitalSud, "<br/>") else ""
)
}
HTML(label)
})
# Carte Leaflet
leaflet(df_filtre) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
radius = 10,
fillColor = "blue",
fillOpacity = 0.7,
stroke = FALSE,
label = labels
)
})
}
# ---------------- Lancer l'application Shiny ----------------
map = shinyApp(ui, server)
map
make_leaflet_map <- function() {
df_filtre <- commune_voiture_velo3 %>%
filter(communes_etudiees == TRUE)
labels <- lapply(1:nrow(df_filtre), function(i) {
row <- df_filtre[i, ]
if (is.na(row$Voiture_Pontchaillou_min) | is.na(row$Voiture_HopitalSud_min) |
row$Voiture_Pontchaillou_min > 60 | row$Voiture_HopitalSud_min > 60) {
label <- paste0(
"<b>", row$nom, "</b><br/>",
"Voiture temps moyen (min) : ", round(row$Voiture_min, 1), "<br/>",
"Voiture distance moyenne (km) : ", round(row$Voiture_km, 1)
)
} else {
label <- paste0(
"<b>", row$nom, "</b><br/>",
if (!is.na(row$Voiture_Pontchaillou_km)) paste0("Distance Pontchaillou (km) : ", row$Voiture_Pontchaillou_km, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_km)) paste0("Distance Hopital Sud (km) : ", row$Voiture_HopitalSud_km, "<br/>") else "",
if (!is.na(row$Voiture_Pontchaillou_min)) paste0("Voiture Pontchaillou (min) : ", row$Voiture_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_min)) paste0("Voiture Hopital Sud (min) : ", row$Voiture_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Velo_Pontchaillou_min)) paste0("Velo Pontchaillou (min) : ", row$Velo_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Velo_HopitalSud_min)) paste0("Velo Hopital Sud (min) : ", row$Velo_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Bus_Pontchaillou)) paste0("Bus Pontchaillou (min) : ", row$Bus_Pontchaillou, "<br/>") else "",
if (!is.na(row$Bus_HopitalSud)) paste0("Bus Hopital Sud (min) : ", row$Bus_HopitalSud, "<br/>") else ""
)
}
htmltools::HTML(label)
})
leaflet(df_filtre) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
radius = 5,
fillColor = "blue",
fillOpacity = 0.7,
stroke = FALSE,
label = labels
)
}
ui <- fluidPage(
titlePanel("Carte interactive des communes étudiées"),
leafletOutput("map", height = 650)
)
library(googleway)
library(mapsapi)
library(sf)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(leaflet)
library(shiny)
library(dplyr)
library(stringr)
library(httr)
library(jsonlite)
library(gtfsrouter)
library(tidytransit)
library(stplanr)
library(htmlwidgets)
# ---------------- UI ----------------
ui <- fluidPage(
titlePanel("Carte interactive des communes étudiées"),
sidebarLayout(
sidebarPanel(
helpText("Affichage uniquement des communes étudiées (communes_etudiees == TRUE).")
),
mainPanel(
leafletOutput("map", height = 650)
)
)
)
# ---------------- SERVER ----------------
server <- function(input, output, session) {
output$map <- renderLeaflet({
# Filtrer les communes étudiées
df_filtre <- commune_voiture_velo3 %>% filter(communes_etudiees == TRUE)
# Construire le label HTML pour le tooltip
labels <- lapply(1:nrow(df_filtre), function(i) {
row <- df_filtre[i, ]
# Condition temps voiture > 60 ou NA
if (is.na(row$Voiture_Pontchaillou_min) | is.na(row$Voiture_HopitalSud_min) |
row$Voiture_Pontchaillou_min > 60 | row$Voiture_HopitalSud_min > 60) {
label <- paste0(
"<b>", row$nom, "</b><br/>",
"Voiture temps moyen (min) : ", round(row$Voiture_min, 1), "<br/>",
"Voiture distance moyenne (km) : ", round(row$Voiture_km, 1)
)
} else {
# Affichage détaillé, sans les NA
label <- paste0(
"<b>", row$nom, "</b><br/>",
if (!is.na(row$Voiture_Pontchaillou_km)) paste0("Distance Pontchaillou (km) : ", row$Voiture_Pontchaillou_km, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_km)) paste0("Distance Hopital Sud (km) : ", row$Voiture_HopitalSud_km, "<br/>") else "",
if (!is.na(row$Voiture_Pontchaillou_min)) paste0("Voiture Pontchaillou (min) : ", row$Voiture_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_min)) paste0("Voiture Hopital Sud (min) : ", row$Voiture_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Velo_Pontchaillou_min)) paste0("Velo Pontchaillou (min) : ", row$Velo_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Velo_HopitalSud_min)) paste0("Velo Hopital Sud (min) : ", row$Velo_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Bus_Pontchaillou)) paste0("Bus Pontchaillou (min) : ", row$Bus_Pontchaillou, "<br/>") else "",
if (!is.na(row$Bus_HopitalSud)) paste0("Bus Hopital Sud (min) : ", row$Bus_HopitalSud, "<br/>") else ""
)
}
HTML(label)
})
# Carte Leaflet
leaflet(df_filtre) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
radius = 10,
fillColor = "blue",
fillOpacity = 0.7,
stroke = FALSE,
label = labels
)
})
}
# ---------------- Lancer l'application Shiny ----------------
map = shinyApp(ui, server)
map
make_leaflet_map <- function() {
df_filtre <- commune_voiture_velo3 %>%
filter(communes_etudiees == TRUE)
labels <- lapply(1:nrow(df_filtre), function(i) {
row <- df_filtre[i, ]
if (is.na(row$Voiture_Pontchaillou_min) | is.na(row$Voiture_HopitalSud_min) |
row$Voiture_Pontchaillou_min > 60 | row$Voiture_HopitalSud_min > 60) {
label <- paste0(
"<b>", row$nom, "</b><br/>",
"Voiture temps moyen (min) : ", round(row$Voiture_min, 1), "<br/>",
"Voiture distance moyenne (km) : ", round(row$Voiture_km, 1)
)
} else {
label <- paste0(
"<b>", row$nom, "</b><br/>",
if (!is.na(row$Voiture_Pontchaillou_km)) paste0("Distance Pontchaillou (km) : ", row$Voiture_Pontchaillou_km, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_km)) paste0("Distance Hopital Sud (km) : ", row$Voiture_HopitalSud_km, "<br/>") else "",
if (!is.na(row$Voiture_Pontchaillou_min)) paste0("Voiture Pontchaillou (min) : ", row$Voiture_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Voiture_HopitalSud_min)) paste0("Voiture Hopital Sud (min) : ", row$Voiture_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Velo_Pontchaillou_min)) paste0("Velo Pontchaillou (min) : ", row$Velo_Pontchaillou_min, "<br/>") else "",
if (!is.na(row$Velo_HopitalSud_min)) paste0("Velo Hopital Sud (min) : ", row$Velo_HopitalSud_min, "<br/>") else "",
if (!is.na(row$Bus_Pontchaillou)) paste0("Bus Pontchaillou (min) : ", row$Bus_Pontchaillou, "<br/>") else "",
if (!is.na(row$Bus_HopitalSud)) paste0("Bus Hopital Sud (min) : ", row$Bus_HopitalSud, "<br/>") else ""
)
}
htmltools::HTML(label)
})
leaflet(df_filtre) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
radius = 5,
fillColor = "blue",
fillOpacity = 0.7,
stroke = FALSE,
label = labels
)
}
ui <- fluidPage(
titlePanel("Carte interactive des communes étudiées"),
leafletOutput("map", height = 650)
)
server <- function(input, output, session) {
output$map <- renderLeaflet({
make_leaflet_map()
})
}
shinyApp(ui, server)
